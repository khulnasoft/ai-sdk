import{d as defineComponent,v as createElementBlock,P as Fragment,Q as renderList,L as unref,x as createBaseVNode,M as withDirectives,N as vModelText,O as isRef,t as openBlock,R as normalizeStyle,y as toDisplayString,B as createTextVNode}from"./entry.zLcKQ_H2.js";import{c as customAlphabet,a as useChat}from"./index.zIW4Ihsd.js";var textStreamPart={code:"0",name:"text",parse:t=>{if(typeof t!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:t}}},functionCallStreamPart={code:"1",name:"function_call",parse:t=>{if(t==null||typeof t!="object"||!("function_call"in t)||typeof t.function_call!="object"||t.function_call==null||!("name"in t.function_call)||!("arguments"in t.function_call)||typeof t.function_call.name!="string"||typeof t.function_call.arguments!="string")throw new Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:t}}},dataStreamPart={code:"2",name:"data",parse:t=>{if(!Array.isArray(t))throw new Error('"data" parts expect an array value.');return{type:"data",value:t}}},errorStreamPart={code:"3",name:"error",parse:t=>{if(typeof t!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:t}}},assistantMessageStreamPart={code:"4",name:"assistant_message",parse:t=>{if(t==null||typeof t!="object"||!("id"in t)||!("role"in t)||!("content"in t)||typeof t.id!="string"||typeof t.role!="string"||t.role!=="assistant"||!Array.isArray(t.content)||!t.content.every(e=>e!=null&&typeof e=="object"&&"type"in e&&e.type==="text"&&"text"in e&&e.text!=null&&typeof e.text=="object"&&"value"in e.text&&typeof e.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:t}}},assistantControlDataStreamPart={code:"5",name:"assistant_control_data",parse:t=>{if(t==null||typeof t!="object"||!("threadId"in t)||!("messageId"in t)||typeof t.threadId!="string"||typeof t.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:t.threadId,messageId:t.messageId}}}},dataMessageStreamPart={code:"6",name:"data_message",parse:t=>{if(t==null||typeof t!="object"||!("role"in t)||!("data"in t)||typeof t.role!="string"||t.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:t}}},toolCallStreamPart={code:"7",name:"tool_calls",parse:t=>{if(t==null||typeof t!="object"||!("tool_calls"in t)||typeof t.tool_calls!="object"||t.tool_calls==null||!Array.isArray(t.tool_calls)||t.tool_calls.some(e=>{e==null||typeof e!="object"||!("id"in e)||typeof e.id!="string"||!("type"in e)||typeof e.type!="string"||!("function"in e)||e.function==null||typeof e.function!="object"||!("arguments"in e.function)||typeof e.function.name!="string"||e.function.arguments}))throw new Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:t}}},streamParts=[textStreamPart,functionCallStreamPart,dataStreamPart,errorStreamPart,assistantMessageStreamPart,assistantControlDataStreamPart,dataMessageStreamPart,toolCallStreamPart];textStreamPart.code+"",functionCallStreamPart.code+"",dataStreamPart.code+"",errorStreamPart.code+"",assistantMessageStreamPart.code+"",assistantControlDataStreamPart.code+"",dataMessageStreamPart.code+"",toolCallStreamPart.code+"";textStreamPart.name+"",textStreamPart.code,functionCallStreamPart.name+"",functionCallStreamPart.code,dataStreamPart.name+"",dataStreamPart.code,errorStreamPart.name+"",errorStreamPart.code,assistantMessageStreamPart.name+"",assistantMessageStreamPart.code,assistantControlDataStreamPart.name+"",assistantControlDataStreamPart.code,dataMessageStreamPart.name+"",dataMessageStreamPart.code,toolCallStreamPart.name+"",toolCallStreamPart.code;streamParts.map(t=>t.code);var nanoid=customAlphabet("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7);new TextDecoder("utf-8");const _hoisted_1={class:"flex flex-col w-full max-w-md py-24 mx-auto stretch"},_hoisted_2=createBaseVNode("br",null,null,-1),_hoisted_3=createBaseVNode("br",null,null,-1),_sfc_main=defineComponent({__name:"index",setup(__props){const functionCallHandler=async(chatMessages,functionCall)=>{if(functionCall.name==="eval_code_in_browser"&&functionCall.arguments){const parsedFunctionCallArguments=JSON.parse(functionCall.arguments);eval(parsedFunctionCallArguments.code);const functionResponse={messages:[...chatMessages,{id:nanoid(),name:"eval_code_in_browser",role:"function",content:parsedFunctionCallArguments.code}]};return functionResponse}},{messages,input,handleSubmit}=useChat({api:"/api/chat-with-functions",experimental_onFunctionCall:functionCallHandler}),roleToColorMap={system:"red",user:"black",function:"blue",tool:"purple",assistant:"green",data:"orange"};return(t,e)=>(openBlock(),createElementBlock("div",_hoisted_1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(messages),a=>(openBlock(),createElementBlock("div",{key:"m.id",class:"whitespace-pre-wrap",style:normalizeStyle({color:roleToColorMap[a.role]})},[createBaseVNode("strong",null,toDisplayString(a.role)+":",1),createTextVNode(" "+toDisplayString(a.content||JSON.stringify(a.function_call))+" ",1),_hoisted_2,_hoisted_3],4))),128)),createBaseVNode("form",{onSubmit:e[1]||(e[1]=(...a)=>unref(handleSubmit)&&unref(handleSubmit)(...a))},[withDirectives(createBaseVNode("input",{class:"fixed bottom-0 w-full max-w-md p-2 mb-8 border border-gray-300 rounded shadow-xl","onUpdate:modelValue":e[0]||(e[0]=a=>isRef(input)?input.value=a:null),placeholder:"Say something..."},null,512),[[vModelText,unref(input)]])],32)]))}});export{_sfc_main as default};
